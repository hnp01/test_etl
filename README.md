# PySpark Healthcare ETL

A full ETL pipeline using PySpark, and Streamlit to process Medicare drug spending data from CMS.gov.

## Data Source

- [CMS Medicare Drug Spending](https://data.cms.gov/provider-summary-by-type-of-service/medicare-part-d-prescribers/part-d-prescribers-by-drug)

## Pipeline Overview

- Ingest raw CSVs (output Bronze)
- Clean and transform (output Silver)
- Aggregate for analysis (output Gold)

## Folder Structure

- `data/raw/`: Download and place the raw CSVs here
- `outputs/`: Auto-generated by the ETL jobs
- `src/`: Source ETL scripts

## How to Run

```bash
pip install -r requirements.txt
spark-submit src/ingest.py
spark-submit src/clean_transform.py
spark-submit src/aggregate.py
```
Updated:
- Start with run.bat first 
- Then spark-submit for the TL codes (this is to lock python to spark)
- Then streamlit run for the dash/app files

## How to View Dashboard and App
https://hnp01.github.io/test_etl/ \
https://rankdashboardapp.streamlit.app/
